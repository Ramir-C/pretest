<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Diagnóstico</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="container">
        <h1>Prueba de Diagnóstico 1</h1>
        <form id="diagnosticForm">
            <label>Nombre de usuario: <input type="text" name="username" required></label><br>
            <label>Edad: <input type="number" name="age" required></label><br>
            <label>Grupo: <input type="text" name="group" required></label><br>
            <label>Escuela: <input type="text" name="school" required></label><br><br>

            <!-- Preguntas -->
            <div class="question">
                <p>1. ¿Cuál de las siguientes opciones describe mejor un cubo?</p>
                <label><input type="radio" name="q1" value="a"> a) Tiene seis caras y todas son rectangulares.</label>
                <label><input type="radio" name="q1" value="b"> b) Tiene seis caras y todas son cuadradas.</label>
                <label><input type="radio" name="q1" value="c"> c) Tiene ocho caras y todas son cuadradas.</label>
            </div>

            <div class="question">
                <p>2. ¿Qué figura geométrica tiene forma de cono?</p>
                <label><input type="radio" name="q2" value="a"> a) Un barquillo de helado.</label>
                <label><input type="radio" name="q2" value="b"> b) Un dado.</label>
                <label><input type="radio" name="q2" value="c"> c) Una pelota de fútbol.</label>
            </div>

            <div class="question">
                <p>3. ¿Cuál de las siguientes opciones describe mejor una pirámide?</p>
                <label><input type="radio" name="q3" value="a"> a) Tiene una base redonda y un solo vértice.</label>
                <label><input type="radio" name="q3" value="b"> b) Tiene una base triangular y es plana.</label>
                <label><input type="radio" name="q3" value="c"> c) Tiene una base cuadrada y cuatro caras.</label>
            </div>

            <div class="question">
                <p>4. ¿Cuál de las siguientes figuras tiene más lados?</p>
                <label><input type="radio" name="q4" value="a"> a) Un triángulo.</label>
                <label><input type="radio" name="q4" value="b"> b) Un cuadrado.</label>
                <label><input type="radio" name="q4" value="c"> c) Un pentágono.</label>
            </div>

            <div class="question">
                <p>5. ¿Qué figura geométrica es similar a una lata de refresco?</p>
                <label><input type="radio" name="q5" value="a"> a) Esfera.</label>
                <label><input type="radio" name="q5" value="b"> b) Cilindro.</label>
                <label><input type="radio" name="q5" value="c"> c) Prisma rectangular.</label>
            </div>

            <div class="question">
                <p>6. ¿Cuál de las siguientes opciones describe mejor un prisma?</p>
                <label><input type="radio" name="q6" value="a"> a) Tiene dos bases circulares y una superficie curva.</label>
                <label><input type="radio" name="q6" value="b"> b) Tiene dos bases paralelas y caras laterales planas.</label>
                <label><input type="radio" name="q6" value="c"> c) Tiene una base triangular y una altura fija.</label>
            </div>

            <div class="question">
                <p>7. ¿Qué figura geométrica es similar a un balón de fútbol?</p>
                <label><input type="radio" name="q7" value="a"> a) Esfera.</label>
                <label><input type="radio" name="q7" value="b"> b) Cubo.</label>
                <label><input type="radio" name="q7" value="c"> c) Cilindro.</label>
            </div>

            <div class="question">
                <p>8. ¿Cuál de las siguientes opciones describe mejor una esfera?</p>
                <label><input type="radio" name="q8" value="a"> a) Tiene una cara y una arista.</label>
                <label><input type="radio" name="q8" value="b"> b) Tiene una base circular y una altura.</label>
                <label><input type="radio" name="q8" value="c"> c) Tiene todas sus partes a la misma distancia del centro.</label>
            </div>

            <div class="question">
                <p>9. ¿En cuántos ejes se puede mover una figura 3D?</p>
                <label><input type="radio" name="q9" value="a"> a) 1</label>
                <label><input type="radio" name="q9" value="b"> b) 3</label>
                <label><input type="radio" name="q9" value="c"> c) 2</label>
            </div>

            <div class="question">
                <p>10. ¿Cuáles son los números impares?</p>
                <label><input type="radio" name="q10" value="a"> a) Son todos aquellos que no llevan un 2.</label>
                <label><input type="radio" name="q10" value="b"> b) Son todos aquellos menores de 100 y que al dividirlos siempre da un número entero.</label>
                <label><input type="radio" name="q10" value="c"> c) Son aquellos números enteros que no son divisibles exactamente por 2.</label>
            </div>

            <button type="button" id="submitButton">Enviar Respuestas</button>
        </form>

        <div id="resultMessage"></div>
    </div>

    <script>
        const correctAnswers = {
            q1: 'b',
            q2: 'a',
            q3: 'c',
            q4: 'c',
            q5: 'b',
            q6: 'b',
            q7: 'a',
            q8: 'c',
            q9: 'b',
            q10: 'c'
        };

        document.getElementById("submitButton").addEventListener("click", async () => {
            const form = document.getElementById("diagnosticForm");
            const formData = new FormData(form);

            const userData = {
  username: formData.get('username'),
  age: formData.get('age'),
  grupo: formData.get('group'), // mapear group → grupo
  school: formData.get('school'),
  correctCount,
  incorrectCount,
  correctAnswers,
  incorrectAnswers
};

            let allAnswered = true;
            for (let i = 1; i <= 10; i++) {
                const answer = formData.get('q' + i);
                if (!answer) allAnswered = false;
                userData.answers['q' + i] = answer;
                if(answer === correctAnswers['q' + i]) {
                    userData.correctCount++;
                    userData.correctAnswers.push(`q${i}${answer}`);
                } else {
                    userData.incorrectCount++;
                    userData.incorrectAnswers.push(`q${i}${answer}`);
                }
            }

            if (!allAnswered) {
                alert("Por favor responde todas las preguntas.");
                return;
            }

            userData.correctAnswers = userData.correctAnswers.join(',');
            userData.incorrectAnswers = userData.incorrectAnswers.join(',');

            try {
                const response = await fetch("/save", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(userData)
                });
                const data = await response.json();

                document.getElementById("resultMessage").innerHTML = `
                    <p>${data.message}</p>
                    <p>Respuestas correctas: ${data.correctAnswers}</p>
                    <p>Respuestas incorrectas: ${data.incorrectAnswers}</p>
                `;
            } catch (err) {
                console.error(err);
                alert("Hubo un error al enviar las respuestas.");
            }
        });
    </script>
</body>
</html>
